{% extends 'main/loggedIn.html'%}

{% block head %} 
<link rel="stylesheet" href="{{url_for('static',filename='css/search.css')}}"> 
<script src ="../../static/js/functions.js"> </script>

{% endblock %}

{% block content %}
<div class = "searchbar">
	<input id="bar" type="text" placeholder="Search ..."> 
	<select name="filters" id="filters">
		<option value="username">Username</option>
		<option value="country">Country</option>
		<option value="location">Location</option>
	</select>
</div>

<div class = "admin-panel"> 
	<button id="get-users" onclick="getResults()"> Get all Users </button>
	<a href="{{url_for('routes.getUsers')}}">See users</a> 
</div> 

<script> 
	function test1(SQL_result) {
		retVal=SQL_result.split("),");
		return retVal;
	}
	
	
	function getResults() {

		let searchTerm = document.getElementById("bar").value; 
		let filter = document.getElementById("filters").value;

		query = "SELECT " + filter + " FROM Users where " +
				filter + " LIKE \'" + searchTerm + "%\';";

		fetch ('/getSearchTerm', {
			headers : {
				'Content-Type': 'application/json'
			},
			method:'POST',
			body: JSON.stringify({
				"search_term":searchTerm,
				"filter":filter,
				"query":query
			})

		}).then(function(response) { 
			return response.text();
		}).then(function(text) {
			console.log(searchTerm);
			console.log(filter);
			console.log(query);
			console.log('POST RESPONSE: ');
			console.log(text);
		})
	}
</script> 
{% endblock %} 

